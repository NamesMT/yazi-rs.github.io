"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[40],{7403:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>r,metadata:()=>l,toc:()=>o});var t=s(1527),i=s(6225);const r={sidebar_position:7,description:"Data Distribution Service"},d="DDS",l={id:"dds",title:"DDS",description:"Data Distribution Service",source:"@site/docs/dds.md",sourceDirName:".",slug:"/dds",permalink:"/docs/dds",draft:!1,unlisted:!1,editUrl:"https://github.com/yazi-rs/yazi-rs.github.io/edit/main/docs/dds.md",tags:[],version:"current",sidebarPosition:7,frontMatter:{sidebar_position:7,description:"Data Distribution Service"},sidebar:"docsSidebar",previous:{title:"Flavors (BETA)",permalink:"/docs/flavors/overview"},next:{title:"Tips",permalink:"/docs/tips"}},c={},o=[{value:"Concept",id:"concept",level:2},{value:"Usage",id:"usage",level:2},{value:"Real-time <code>stdout</code> reporting",id:"stdout-reporting",level:3},{value:"Builtin kinds",id:"builtin",level:2},{value:"<code>cd</code>",id:"cd",level:3},{value:"<code>hover</code>",id:"hover",level:3},{value:"<code>rename</code>",id:"rename",level:3},{value:"<code>bulk</code>",id:"bulk",level:3},{value:"<code>yank</code>",id:"yank",level:3},{value:"<code>hi</code>",id:"hi",level:3},{value:"<code>hey</code>",id:"hey",level:3}];function a(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"dds",children:"DDS"}),"\n",(0,t.jsxs)(n.admonition,{type:"warning",children:[(0,t.jsx)(n.p,{children:"This is a new feature that will be released in Yazi 0.2.5 and currently requires the latest main branch."}),(0,t.jsx)(n.p,{children:"Document is still being written..."})]}),"\n",(0,t.jsx)(n.p,{children:"DDS (Data Distribution Service) is designed to achieve communication and state synchronization between multiple Yazi instances, as well as state persistence. It is built on a client-server architecture but does not require running additional server processes."}),"\n",(0,t.jsx)(n.p,{children:"It deeply integrates with a publish-subscribe model based on the Lua API."}),"\n",(0,t.jsx)(n.h2,{id:"concept",children:"Concept"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Local: the current instance, that is, the current Yazi process."}),"\n",(0,t.jsx)(n.li,{children:"Remote: instances other than the current instance."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,t.jsx)(n.p,{children:"The DDS has two usage:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/docs/plugins/utils#ps",children:"Plugin API"}),": Using Lua-based publish-subscribe model as the carrier for DDS."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsxs)(n.a,{href:"#stdout-reporting",children:["Real-time ",(0,t.jsx)(n.code,{children:"stdout"})," reporting"]}),": Using ",(0,t.jsx)(n.code,{children:"stdout"})," as the carrier for DDS."]}),"\n"]}),"\n",(0,t.jsxs)(n.h3,{id:"stdout-reporting",children:["Real-time ",(0,t.jsx)(n.code,{children:"stdout"})," reporting"]}),"\n",(0,t.jsxs)(n.p,{children:["You can specify the ",(0,t.jsx)(n.code,{children:"--local-events"})," and ",(0,t.jsx)(n.code,{children:"--remote-events"})," options when starting Yazi:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"# Local events\nyazi --local-events=kind1,kind2\n# Remote events\nyazi --remote-events=kind1,kind2\n# Both local and remote events\nyazi --local-events=kind1,kind2 --remote-events=kind1,kind2\n"})}),"\n",(0,t.jsxs)(n.p,{children:["When an event of the specified kind is triggered, it will be output to ",(0,t.jsx)(n.code,{children:"stdout"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:'hover,0,200,{"tab":0,"url":"/root/Downloads"}\ncd,0,100,{"tab":0,"url":"/root/Downloads"}\n'})}),"\n",(0,t.jsx)(n.p,{children:"One payload per line, each payload contains the following fields separated by commas:"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Field"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"kind"}),(0,t.jsx)(n.td,{children:"The kind of this message"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"receiver"}),(0,t.jsxs)(n.td,{children:["The remote instance ID that receives this message; if it's ",(0,t.jsx)(n.code,{children:"0"}),", broadcasts to all remote instances"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"sender / severity"}),(0,t.jsxs)(n.td,{children:["The sender of this message if greater than ",(0,t.jsx)(n.code,{children:"65535"}),"; otherwise, the severity of this ",(0,t.jsx)(n.a,{href:"/docs/plugins/utils#ps.pub_static",children:"static message"})]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"body"}),(0,t.jsx)(n.td,{children:"The body of this message, which is a JSON string"})]})]})]}),"\n",(0,t.jsx)(n.p,{children:"This provides the ability to report Yazi's internal events in real-time, which is useful for external tool integration (such as Neovim), as they will be able to subscribe to the events triggered by the user behavior."}),"\n",(0,t.jsx)(n.h2,{id:"builtin",children:"Builtin kinds"}),"\n",(0,t.jsx)(n.h3,{id:"cd",children:(0,t.jsx)(n.code,{children:"cd"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"sub()"})," callback body:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"{\n\ttab = 0\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"sub_remote()"})," callback body:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:'{\n\ttab = 0,\n\turl = Url("/root/Downloads")\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"--local-events"})," stdout payload:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:'cd,1711957542289249,1711957542289249,{"tab":0,"url":"/root/Downloads"}\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"--remote-events"})," stdout payload:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:'cd,0,100,{"tab":0,"url":"/root/Downloads"}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"hover",children:(0,t.jsx)(n.code,{children:"hover"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"sub()"})," callback body:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"{\n\ttab = 0\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"sub_remote()"})," callback body:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:'{\n\ttab = 0,\n\turl = Url("/root/foo.txt")\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"--local-events"})," stdout payload:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:'hover,1711957283332834,1711957283332834,{"tab":0,"url":"/root/foo.txt"}\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"--remote-events"})," stdout payload:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:'hover,0,200,{"tab":0,"url":"/root/foo.txt"}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"rename",children:(0,t.jsx)(n.code,{children:"rename"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"sub()"})," callback body:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:'{\n  tab = 0,\n  from = Url("/root/foo.txt"),\n  to = Url("/root/bar.txt"),\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"sub_remote()"})," callback body:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:'{\n  tab = 0,\n  from = Url("/root/foo.txt"),\n  to = Url("/root/bar.txt"),\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"--local-events"})," stdout payload:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:'rename,1711957878076791,1711957878076791,{"tab":0,"from":"/root/foo.txt","to":"/root/bar.txt"}\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"--remote-events"})," stdout payload:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:'rename,0,1711957878076791,{"tab":0,"from":"/root/foo.txt","to":"/root/bar.txt"}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"bulk",children:(0,t.jsx)(n.code,{children:"bulk"})}),"\n",(0,t.jsx)(n.p,{children:"TODO"}),"\n",(0,t.jsx)(n.h3,{id:"yank",children:(0,t.jsx)(n.code,{children:"yank"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"sub()"})," callback body:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"{}\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"sub_remote()"})," callback body:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"-- Since `Iterator` implementing `__index()`, you can access the yanked URLs by index,\n-- such as `body[1]`, or iterate over all URLs using `ipairs(body)`\nIterator {\n\tcut = false,\n\t__len = function(self)\n\t\t-- Returns the number of URLs yanked\n\tend,\n\t__index = function(self, idx)\n\t\t-- Returns the URL at the given index\n\tend\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"--local-events"})," stdout payload:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:'yank,1711960311454247,1711960311454247,{"cut":false,"urls":["/root/foo.txt","/root/bar.txt"]}\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"--remote-events"})," stdout payload:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:'yank,0,300,{"cut":false,"urls":["/root/foo.txt","/root/bar.txt"]}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"hi",children:(0,t.jsx)(n.code,{children:"hi"})}),"\n",(0,t.jsx)(n.p,{children:"System reserves kind."}),"\n",(0,t.jsx)(n.h3,{id:"hey",children:(0,t.jsx)(n.code,{children:"hey"})}),"\n",(0,t.jsx)(n.p,{children:"System reserves kind."})]})}function h(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},6225:(e,n,s)=>{s.d(n,{Z:()=>l,a:()=>d});var t=s(959);const i={},r=t.createContext(i);function d(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);